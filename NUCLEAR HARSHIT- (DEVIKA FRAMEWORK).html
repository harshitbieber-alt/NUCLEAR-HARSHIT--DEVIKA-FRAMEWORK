<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dharma & Deterrence — DEVIKA Framework</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    :root {
      --bg: #0b1220;
      --card: #0f172a;
      --ink: #e5e7eb;
      --muted: #94a3b8;
      --accent: #38bdf8;
      --good: #22c55e;
      --warn: #f59e0b;
      --bad: #ef4444;
      --theme-D: #ff9d00;
      --theme-E: #38bdf8;
      --theme-V: #ef4444;
      --theme-I: #8b5cf6;
      --theme-K: #22c55e;
      --theme-A: #06b6d4;
    }
    
    * { 
      box-sizing: border-box; 
      margin: 0;
      padding: 0;
    }
    
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg);
      color: var(--ink);
      line-height: 1.6;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }
    
    header {
      text-align: center;
      padding: 20px 0;
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
      border-bottom: 1px solid #1f2937;
      margin-bottom: 30px;
    }
    
    header h1 {
      font-size: 2.8rem;
      margin-bottom: 10px;
      background: linear-gradient(to right, #38bdf8, #22c55e);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    header p {
      color: var(--muted);
      max-width: 800px;
      margin: 0 auto;
    }
    
    .author {
      color: var(--accent);
      font-weight: 600;
      margin-top: 10px;
    }
    
    .card {
      background: var(--card);
      border: 1px solid #1f2937;
      border-radius: 16px;
      box-shadow: 0 12px 30px rgba(0,0,0,.35);
      padding: 24px;
      margin-bottom: 24px;
    }
    
    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      align-items: center;
      justify-content: center;
    }
    
    .control-group {
      display: flex;
      flex-direction: column;
      min-width: 250px;
    }
    
    label {
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--accent);
    }
    
    select, button {
      padding: 12px 16px;
      border-radius: 12px;
      border: 1px solid #233045;
      background: #111827;
      color: var(--ink);
      font-weight: 600;
      font-size: 1rem;
    }
    
    button {
      background: linear-gradient(180deg, #0ea5e9, #0284c7);
      border: none;
      cursor: pointer;
      transition: all 0.2s;
      min-width: 200px;
    }
    
    button:hover {
      background: linear-gradient(180deg, #0284c7, #0369a1);
      transform: translateY(-2px);
    }
    
    .pill-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      justify-content: center;
      margin-top: 15px;
    }
    
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: #0b2540;
      border: 1px solid #173a5e;
      color: #c7d2fe;
      padding: 8px 14px;
      border-radius: 999px;
      font-size: 14px;
    }
    
    .response-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
    }
    
    .response-card {
      background: #0f172a;
      border: 1px solid #1f2937;
      border-radius: 16px;
      padding: 24px;
    }
    
    .response-title {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 12px;
      color: var(--accent);
    }
    
    .escalation {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 16px;
    }
    
    .low { background: #22c55e20; color: var(--good); border: 1px solid #22c55e40; }
    .medium { background: #f59e0b20; color: var(--warn); border: 1px solid #f59e0b40; }
    .high { background: #ef444420; color: var(--bad); border: 1px solid #ef444440; }
    .critical { background: #dc262620; color: #dc2626; border: 1px solid #dc262640; }
    
    .doctrine-point {
      margin: 16px 0;
      padding: 12px;
      background: #0b2540;
      border-left: 4px solid var(--accent);
      border-radius: 0 8px 8px 0;
    }
    
    .citation-link {
      color: #93c5fd;
      cursor: pointer;
      text-decoration: underline;
    }
    
    .citation-link:hover { color: #bfdbfe; }
    
    /* DEVIKA Framework Styles */
    .devika-header {
      text-align: center;
      margin: 40px 0 30px;
    }
    
    .devika-header h2 {
      font-size: 32px;
      color: var(--accent);
      margin-bottom: 12px;
    }
    
    .action-indicator {
      display: inline-block;
      padding: 8px 20px;
      border-radius: 20px;
      background: #1e3a8a;
      color: var(--accent);
      font-size: 16px;
      margin: 20px 0;
      font-weight: 600;
    }
    
    .theme-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin: 30px 0;
    }
    
    .theme-card {
      background: #0b2540;
      border: 1px solid #173a5e;
      border-radius: 14px;
      padding: 20px;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
    }
    
    .theme-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 20px -10px rgba(0, 0, 0, 0.15);
    }
    
    .theme-D { border-left: 4px solid var(--theme-D); }
    .theme-E { border-left: 4px solid var(--theme-E); }
    .theme-V { border-left: 4px solid var(--theme-V); }
    .theme-I { border-left: 4px solid var(--theme-I); }
    .theme-K { border-left: 4px solid var(--theme-K); }
    .theme-A { border-left: 4px solid var(--theme-A); }
    
    .theme-header {
      display: flex;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .theme-icon {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      margin-right: 16px;
      font-weight: bold;
      font-size: 18px;
    }
    
    .theme-icon.D { color: var(--theme-D); }
    .theme-icon.E { color: var(--theme-E); }
    .theme-icon.V { color: var(--theme-V); }
    .theme-icon.I { color: var(--theme-I); }
    .theme-icon.K { color: var(--theme-K); }
    .theme-icon.A { color: var(--theme-A); }
    
    .chart-container {
      position: relative;
      height: 400px;
      width: 100%;
      margin: 30px 0;
    }
    
    .charts-grid {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
    }
    
    @media (min-width: 992px) {
      .charts-grid {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.85);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }
    
    .modal.visible {
      display: flex;
    }
    
    .modal-content {
      background: var(--card);
      border-radius: 16px;
      padding: 30px;
      max-width: 800px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
      border: 1px solid #1f2937;
    }
    
    .close-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: none;
      border: none;
      color: var(--muted);
      font-size: 28px;
      cursor: pointer;
    }
    
    .shloka-item {
      background: #0b2540;
      border-left: 4px solid var(--accent);
      padding: 20px;
      margin: 20px 0;
      border-radius: 0 8px 8px 0;
    }
    
    footer {
      text-align: center;
      padding: 30px 0;
      margin-top: 50px;
      border-top: 1px solid #1f2937;
      color: var(--muted);
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      header h1 {
        font-size: 2.2rem;
      }
      
      .controls {
        flex-direction: column;
      }
      
      .control-group {
        width: 100%;
      }
      
      button {
        width: 100%;
      }
      
      .theme-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <header>
    <div class="container">
      <h1>Dharma & Deterrence — DEVIKA Framework</h1>
      <p>An integrated analysis of India's strategic doctrine and its scriptural foundations</p>
      <p class="author">By Harshit Kumar, PhD Scholar, BITS Pilani | Under Supervision of Prof. Devika Sangwan</p>
    </div>
  </header>

  <main class="container">
    <section class="card">
      <h2>Strategic Response Recommender</h2>
      <p>Select an enemy action to see India's recommended response based on nuclear doctrine and dharmic principles</p>
      
      <div class="controls">
        <div class="control-group">
          <label for="enemy">Enemy Action:</label>
          <select id="enemy">
            <option value="peace">Peace / Ceasefire Hold</option>
            <option value="probe">Border Probe / Limited Incursion</option>
            <option value="terror">Proxy Terror Attack</option>
            <option value="major">Major Conventional Attack</option>
            <option value="cyber">Cyber Attack on Critical Infrastructure</option>
            <option value="naval">Naval Blockade / Maritime Coercion</option>
            <option value="tacticalNuke">Tactical Nuclear Use</option>
            <option value="strategicNuke">Strategic Nuclear Strike</option>
          </select>
        </div>
        
        <div class="control-group">
          <label for="mode">Response Mode:</label>
          <select id="mode">
            <option value="strict">Strict Doctrine</option>
            <option value="ethics">Ethics-First</option>
          </select>
        </div>
        
        <div class="control-group">
          <label>&nbsp;</label>
          <button id="show">Show Recommended Response</button>
        </div>
      </div>
      
      <div class="pill-container">
        <span class="pill">No First Use (NFU)</span>
        <span class="pill">Proportionality</span>
        <span class="pill">Non-combatant Immunity</span>
        <span class="pill">Last Resort</span>
      </div>
    </section>

    <section class="response-grid" id="result">
      <!-- Response will be displayed here -->
    </section>

    <section class="card" id="devika-section">
      <div class="devika-header">
        <h2>DEVIKA Framework Analysis</h2>
        <p>Scriptural Foundations of India's Nuclear Doctrine</p>
        <div class="action-indicator" id="action-indicator">Current Analysis: Peace / Ceasefire Hold (Ethics-First)</div>
      </div>
      
      <div class="theme-grid">
        <div class="theme-card theme-D">
          <div class="theme-header">
            <div class="theme-icon D">D</div>
            <h3>Deterrence (प्रतिरोध)</h3>
          </div>
          <p>Credible Minimum Deterrence: Strength accumulated solely for resistance.</p>
        </div>
        
        <div class="theme-card theme-E">
          <div class="theme-header">
            <div class="theme-icon E">E</div>
            <h3>Ethical Restraint (नैतिक संयम)</h3>
          </div>
          <p>No First Use + Civilian Control: Adherence to policy and dharma.</p>
        </div>
        
        <div class="theme-card theme-V">
          <div class="theme-header">
            <div class="theme-icon V">V</div>
            <h3>Vengeance (प्रतिशोध)</h3>
          </div>
          <p>Massive Retaliation: Harsh punishment in response to injustice.</p>
        </div>
        
        <div class="theme-card theme-I">
          <div class="theme-header">
            <div class="theme-icon I">I</div>
            <h3>Institutional Authority (संस्थागत प्राधिकार)</h3>
          </div>
          <p>Civilian Command: Decisions only from democratic institutions.</p>
        </div>
        
        <div class="theme-card theme-K">
          <div class="theme-header">
            <div class="theme-icon K">K</div>
            <h3>Karmik Consequences (कर्मिक परिणाम)</h3>
          </div>
          <p>Conditional Response: Nuclear retaliation as karmic result for adharma.</p>
        </div>
        
        <div class="theme-card theme-A">
          <div class="theme-header">
            <div class="theme-icon A">A</div>
            <h3>Ahimsa (अहिंसा)</h3>
          </div>
          <p>Non-Violence: India's faith in global disarmament and compassion.</p>
        </div>
      </div>
      
      <div class="card">
        <h3>Scriptural Support Analysis</h3>
        <div class="chart-container">
          <canvas id="barChart"></canvas>
        </div>
      </div>
      
      <div class="charts-grid">
        <div class="card">
          <h3>Balance of Themes</h3>
          <div class="chart-container">
            <canvas id="radarChart"></canvas>
          </div>
        </div>
        
        <div class="card">
          <h3>Distribution of Scriptural References</h3>
          <div class="chart-container">
            <canvas id="pieChart"></canvas>
          </div>
        </div>
      </div>
      
      <div class="card">
        <h3>Research Methodology</h3>
        <p>This analysis employs a multidisciplinary methodology combining textual analysis of primary doctrinal documents, historical contextualization of India's nuclear journey, and conceptual examination of key terms.</p>
        <ul>
          <li>Systematic coding of scriptural references</li>
          <li>Expert validation of thematic assignments</li>
          <li>Inter-coder reliability checks</li>
          <li>Quantitative analysis of theme frequency</li>
        </ul>
      </div>
    </section>
  </main>

  <!-- Verse Popup Modal -->
  <div class="modal" id="verseModal">
    <div class="modal-content">
      <button class="close-btn" id="closeVerseModal">&times;</button>
      <h3 id="verseTitle">Scriptural Verse</h3>
      <div id="verseContent"></div>
    </div>
  </div>
  
  <!-- DEVIKA Shloka Modal -->
  <div class="modal" id="devikaModal">
    <div class="modal-content">
      <button class="close-btn" id="closeDevikaModal">&times;</button>
      <h3 id="devikaTitle">Scriptural References</h3>
      <div id="devikaContent"></div>
    </div>
  </div>

  <footer>
    <div class="container">
      <p>© 2025 Dharma & Deterrence — DEVIKA Framework Research Project</p>
      <p>Academic use permitted with proper attribution</p>
      <p>By Harshit Kumar, PhD Scholar, Department of Humanities & Social Sciences, BITS Pilani</p>
    </div>
  </footer>

  <script>
    // ----------------- Data from First Code -----------------
    const verses = {
      "Bhagavad Gita 2.31": {
        sanskrit: "स्वधर्ममपि चावेक्ष्य न विकम्पितुमर्हसि | धर्म्याद्धि युद्धाच्छ्रेयोऽन्यत्क्षत्रियस्य न विद्यते ||",
        translation: "Looking at your own dharma, you should not waver. For a kshatriya, there is nothing better than a righteous war.",
        context: "Krishna advises Arjuna on the duty of a warrior to fight when dharma is at stake."
      },
      "Bhagavad Gita 2.33": {
        sanskrit: "अथ चेत्त्वमिमं धर्म्यं संग्रामं न करिष्यसि | ततः स्वधर्मं कीर्तिं च हित्वा पापमवाप्स्यसि ||",
        translation: "If you do not fight this righteous war, then you will fail in your duty, lose your reputation, and incur sin.",
        context: "Krishna explains the consequences of abandoning one's dharmic duty in times of crisis."
      },
      "Bhagavad Gita 2.47": {
        sanskrit: "कर्मण्येवाधिकारस्ते मा फलेषु कदाचन | मा कर्मफलहेतुर्भूर्मा ते सङ्गोऽस्त्वकर्मणि ||",
        translation: "You have a right to perform your prescribed duty, but not to the fruits of action. Never consider yourself the cause of the results, nor be attached to not doing your duty.",
        context: "The fundamental principle of nishkama karma - acting without attachment to results."
      },
      "Bhagavad Gita 16.1-3": {
        sanskrit: "अभयं सत्त्वसंशुद्धिर्ज्ञानयोगव्यवस्थितिः | दानं दमश्च यज्ञश्च स्वाध्यायस्तप आर्जवम् | अहिंसा सत्यमक्रोधस्त्यागः शान्तिरपैशुनम् | दया भूतेष्वलोलुप्त्वं मार्दवं ह्रीरचापलम् |",
        translation: "Fearlessness, purity of mind, steadfastness in yoga and knowledge, charity, self-control, sacrifice, study of scriptures, austerity, honesty, non-violence, truthfulness, absence of anger, renunciation, peace, absence of fault-finding, compassion for all beings, freedom from greed, gentleness, modesty, reliability...",
        context: "Divine qualities that should guide righteous conduct in all situations."
      },
      "Mahabharata Sabha Parva 2.5.23": {
        sanskrit: "धर्मस्य तत्त्वं निहितं गुहायां महाजनो येन गतः स पन्थाः | तर्कोऽप्रतिष्ठः श्रुतयो विभिन्ना नैको ऋषिर्यस्य वाक्यं प्रमाणम् ||",
        translation: "The essence of dharma is hidden in the cave of the heart. The path taken by great souls is the right path. Logic is uncertain, scriptures differ, and no single sage's opinion is authoritative.",
        context: "Yudhishthira's reflection on the complexity of determining righteous action."
      },
      "Mahabharata Vana Parva 3.35.27": {
        sanskrit: "न धर्माद्धि परं किंचित्त्रिषु लोकेषु विद्यते | न धर्मेण बलं किंचिन्न धर्मात्परमं सुखम् ||",
        translation: "There is no friend higher than dharma, no strength greater than dharma, no refuge superior to dharma, and no happiness beyond dharma.",
        context: "The supremacy of dharma in all aspects of life, even during warfare."
      },
      "Mahabharata Shanti Parva 12.15.7": {
        sanskrit: "आत्मजयः पराजयात्परमो विजयः स्मृतः | आत्मा ह्यस्य जितः पूर्वं येनान्यो जयते रिपुम् ||",
        translation: "Self-conquest is the greatest victory, the most difficult of all victories. One who first conquers oneself, then conquers enemies.",
        context: "The importance of self-mastery before engaging in external conflicts."
      },
      "Mahabharata Shanti Parva 12.15.20": {
        sanskrit: "अधर्मेण जितं लोकं पुनर्धर्मेण जयति | धर्मं सत्यं इति प्राहुः सर्वं सत्ये प्रतिष्ठितम् ||",
        translation: "The world conquered by adharma can be reconquered by dharma. Dharma is truth, they say, and everything is established in truth.",
        context: "The ultimate victory of dharma over adharma in the cosmic order."
      },
      "Mahabharata Shanti Parva 12.120.5": {
        sanskrit: "समुद्रः पृथिवीपाल न कस्यचिद्धनं महान् | अपां पूर्णो महाभाग सर्वभूतहिते रतः ||",
        translation: "The ocean, supporter of the earth and well-wisher of all beings, cannot be claimed as property by anyone - this great reservoir of waters.",
        context: "The concept of global commons and shared natural resources."
      },
      "Arthashastra 4.10.15": {
        sanskrit: "धर्मः क्षेत्रस्य मूलं तस्माद्धर्मं समाचरेत् | अधर्मेणेतरः क्षेत्रं भुञ्जानो नश्यते नृपः ||",
        translation: "Justice is the root of the kingdom, therefore one should practice justice. A king who enjoys the kingdom through injustice perishes.",
        context: "Kautilya's emphasis on justice as the foundation of legitimate governance."
      },
      "Arthashastra 6.2.13-15": {
        sanskrit: "सामदण्डौ प्रधानौ हि राज्ञः सिद्धिकरावुभौ | तयोः साम प्रयोक्तव्यं दण्डः सर्वात्मना त्यजेत् ||",
        translation: "Sama (conciliation), dana (gifts), danda (punishment), and bheda (division) are the four royal methods. Among these, sama should be tried first, danda is the last resort among all methods.",
        context: "The hierarchy of diplomatic and military options available to rulers."
      },
      "Arthashastra 7.6.41": {
        sanskrit: "येन येन हि युक्तेन शत्रुर्हन्यात्स्वबन्धुषु | तेन तेनैव युक्तेन प्रत्यादेयः स शत्रुषु ||",
        translation: "Whatever means the enemy uses to harm one's own state, the same means should be used to retaliate against them.",
        context: "The principle of proportionate response in statecraft and warfare."
      },
      "Arthashastra 7.11.24": {
        sanskrit: "जलमार्गनियमः सर्वतः प्रयोजनवान् | अतः जलमार्गरक्षणं प्रधानं कार्यम् ||",
        translation: "Control of waterways enhances the prosperity of the state everywhere. Therefore, protection of water routes should be given primary importance.",
        context: "The strategic importance of maritime and riverine trade routes."
      },
      "Arthashastra 7.14.17": {
        sanskrit: "प्रतिकारे प्रमाणेन युक्तः प्रत्ययः क्षमः | अतिक्रमे दोषभागी न्यूने पराजितो भवेत् ||",
        translation: "In response to aggression, retaliation should be measured and appropriate. Excess leads to fault, while inadequacy leads to defeat.",
        context: "The doctrine of proportionate response in military affairs."
      }
    };

    const responses = {
      peace: {
        strict: {
          title: "Maintain Peaceful Posture",
          escalation: "low",
          response: "Continue diplomatic engagement and confidence-building measures while maintaining defensive readiness.",
          doctrine: [
            "Uphold ceasefire agreements per dharmic commitment to truth (satya)",
            "Maintain credible deterrence through visible but non-provocative military posture",
            "Engage in Track II diplomacy and cultural exchanges"
          ],
          ethics: "Peace is the highest dharma when both sides honor agreements",
          citation: "Bhagavad Gita 2.47",
          devikaScores: { D: 0.6, E: 0.9, V: 0.2, I: 0.7, K: 0.5, A: 0.95 }
        },
        ethics: {
          title: "Active Peace Building",
          escalation: "low",
          response: "Proactively build peace through humanitarian cooperation, trade, and people-to-people connections.",
          doctrine: [
            "Lead by example in upholding international law and dharmic principles",
            "Offer humanitarian assistance during natural disasters regardless of political tensions",
            "Promote cultural and educational exchanges to build understanding"
          ],
          ethics: "True victory is achieved through dharma, not force",
          citation: "Mahabharata Shanti Parva 12.15.7",
          devikaScores: { D: 0.5, E: 0.95, V: 0.1, I: 0.8, K: 0.6, A: 0.98 }
        }
      },
      probe: {
        strict: {
          title: "Measured Defensive Response",
          escalation: "low",
          response: "Deploy border forces to contested area, issue diplomatic protest, and demonstrate resolve without escalation.",
          doctrine: [
            "Maintain NFU commitment while showing conventional deterrence capability",
            "Use minimum necessary force to restore status quo ante",
            "Document violations for international legal proceedings"
          ],
          ethics: "Proportionate response maintains dharma while deterring aggression",
          citation: "Arthashastra 7.14.17",
          devikaScores: { D: 0.7, E: 0.8, V: 0.4, I: 0.75, K: 0.6, A: 0.7 }
        },
        ethics: {
          title: "Dharmic Boundary Defense",
          escalation: "medium",
          response: "Firm but restrained response prioritizing de-escalation while protecting territorial integrity.",
          doctrine: [
            "Offer face-saving withdrawal opportunity before applying force",
            "Ensure all actions comply with international humanitarian law",
            "Seek third-party mediation if direct talks fail"
          ],
          ethics: "Defending righteous territory is dharmic duty, but with minimal harm",
          citation: "Bhagavad Gita 2.31",
          devikaScores: { D: 0.75, E: 0.85, V: 0.5, I: 0.8, K: 0.7, A: 0.8 }
        }
      },
      terror: {
        strict: {
          title: "Surgical Counter-Terror Operations",
          escalation: "medium",
          response: "Conduct precise military strikes against terror infrastructure while maintaining plausible deniability.",
          doctrine: [
            "Target only military and terror-related infrastructure",
            "Maintain nuclear threshold discipline despite provocation",
            "Coordinate with international counter-terrorism frameworks"
          ],
          ethics: "Eliminating terror infrastructure protects innocent lives",
          citation: "Mahabharata Sabha Parva 2.5.23",
          devikaScores: { D: 0.8, E: 0.7, V: 0.75, I: 0.8, K: 0.8, A: 0.5 }
        },
        ethics: {
          title: "Justice-Focused Response",
          escalation: "medium",
          response: "Combine targeted operations with international legal action and humanitarian protection measures.",
          doctrine: [
            "Prioritize capturing perpetrators for legal justice over elimination",
            "Provide aid to terror victims regardless of nationality",
            "Work through international courts to establish accountability"
          ],
          ethics: "Justice through law upholds dharma better than revenge",
          citation: "Arthashastra 4.10.15",
          devikaScores: { D: 0.75, E: 0.85, V: 0.6, I: 0.85, K: 0.85, A: 0.7 }
        }
      },
      major: {
        strict: {
          title: "Full Conventional Response",
          escalation: "high",
          response: "Launch comprehensive conventional counter-offensive to defeat aggression and restore deterrence.",
          doctrine: [
            "Maintain NFU while demonstrating conventional superiority",
            "Target military objectives to degrade enemy war-fighting capability",
            "Prepare for potential nuclear escalation by adversary"
          ],
          ethics: "Righteous war against unprovoked aggression is dharmic duty",
          citation: "Bhagavad Gita 2.33",
          devikaScores: { D: 0.9, E: 0.6, V: 0.85, I: 0.8, K: 0.75, A: 0.4 }
        },
        ethics: {
          title: "Dharmic War Conduct",
          escalation: "high",
          response: "Conduct military operations with strict adherence to dharmic principles and international humanitarian law.",
          doctrine: [
            "Offer surrender terms that preserve enemy dignity",
            "Protect all non-combatants and civilian infrastructure",
            "Limit objectives to restoring peace, not conquest"
          ],
          ethics: "Even in war, dharma must guide every action",
          citation: "Mahabharata Vana Parva 3.35.27",
          devikaScores: { D: 0.85, E: 0.8, V: 0.7, I: 0.85, K: 0.8, A: 0.6 }
        }
      },
      cyber: {
        strict: {
          title: "Cyber Counter-Operations",
          escalation: "medium",
          response: "Launch proportionate cyber counter-attacks against adversary's critical infrastructure.",
          doctrine: [
            "Target military and government cyber infrastructure",
            "Maintain escalation control to prevent conventional spillover",
            "Demonstrate cyber deterrence capability"
          ],
          ethics: "Cyber warfare must follow same proportionality principles as kinetic warfare",
          citation: "Arthashastra 7.6.41",
          devikaScores: { D: 0.75, E: 0.7, V: 0.65, I: 0.8, K: 0.7, A: 0.5 }
        },
        ethics: {
          title: "Defensive Cyber Dharma",
          escalation: "low",
          response: "Focus on defensive measures and international cooperation rather than offensive cyber operations.",
          doctrine: [
            "Strengthen cyber defenses and resilience",
            "Share threat intelligence with international partners",
            "Pursue cyber criminals through legal channels"
          ],
          ethics: "Protection is more dharmic than retaliation in cyber domain",
          citation: "Bhagavad Gita 16.1-3",
          devikaScores: { D: 0.65, E: 0.9, V: 0.4, I: 0.85, K: 0.6, A: 0.85 }
        }
      },
      naval: {
        strict: {
          title: "Naval Counter-Blockade",
          escalation: "high",
          response: "Break blockade through naval operations while maintaining freedom of navigation.",
          doctrine: [
            "Assert right to freedom of navigation under international law",
            "Use minimum force necessary to break blockade",
            "Coordinate with international maritime coalition"
          ],
          ethics: "Protecting trade routes serves greater good of all nations",
          citation: "Arthashastra 7.11.24",
          devikaScores: { D: 0.85, E: 0.7, V: 0.75, I: 0.8, K: 0.7, A: 0.6 }
        },
        ethics: {
          title: "Diplomatic Maritime Resolution",
          escalation: "medium",
          response: "Seek international arbitration while maintaining naval presence to deter further coercion.",
          doctrine: [
            "Invoke international maritime law and UN arbitration",
            "Maintain naval presence without provocative actions",
            "Offer face-saving compromise on maritime boundaries"
          ],
          ethics: "Peaceful resolution of maritime disputes serves all coastal peoples",
          citation: "Mahabharata Shanti Parva 12.120.5",
          devikaScores: { D: 0.7, E: 0.85, V: 0.5, I: 0.9, K: 0.75, A: 0.8 }
        }
      },
      tacticalNuke: {
        strict: {
          title: "Massive Nuclear Retaliation",
          escalation: "critical",
          response: "Launch immediate and massive nuclear retaliation as per declared doctrine.",
          doctrine: [
            "Execute massive retaliation doctrine without delay",
            "Target adversary's nuclear forces and command structure",
            "Maintain second-strike capability for extended deterrence"
          ],
          ethics: "Nuclear first use by enemy justifies proportionate nuclear response",
          citation: "India's Nuclear Doctrine 2003",
          devikaScores: { D: 0.95, E: 0.3, V: 0.95, I: 0.9, K: 0.9, A: 0.2 }
        },
        ethics: {
          title: "Graduated Nuclear Response",
          escalation: "critical",
          response: "Measured nuclear response targeting military objectives while seeking immediate ceasefire.",
          doctrine: [
            "Limited nuclear response proportionate to attack scale",
            "Target military objectives, avoid civilian areas",
            "Immediately offer ceasefire and peace negotiations"
          ],
          ethics: "Even nuclear response must minimize harm to innocents",
          citation: "Bhagavad Gita 2.47",
          devikaScores: { D: 0.9, E: 0.6, V: 0.8, I: 0.9, K: 0.85, A: 0.4 }
        }
      },
      strategicNuke: {
        strict: {
          title: "Full Nuclear Retaliation",
          escalation: "critical",
          response: "Launch comprehensive nuclear retaliation to ensure adversary's complete destruction as deterrent.",
          doctrine: [
            "Execute full second-strike capability",
            "Target all adversary nuclear forces and major military installations",
            "Ensure credible deterrence for future adversaries"
          ],
          ethics: "Survival of the nation justifies maximum retaliation",
          citation: "India's Nuclear Doctrine 2003",
          devikaScores: { D: 0.98, E: 0.2, V: 0.98, I: 0.95, K: 0.95, A: 0.1 }
        },
        ethics: {
          title: "Dharmic Nuclear Response",
          escalation: "critical",
          response: "Substantial nuclear retaliation while attempting to preserve possibility of future peace.",
          doctrine: [
            "Massive but targeted nuclear response",
            "Avoid targeting civilian population centers where possible",
            "Maintain communication channels for eventual peace"
          ],
          ethics: "Even in ultimate retaliation, dharma demands restraint where possible",
          citation: "Mahabharata Shanti Parva 12.15.20",
          devikaScores: { D: 0.95, E: 0.5, V: 0.9, I: 0.95, K: 0.9, A: 0.3 }
        }
      }
    };

    // ----------------- Data from Second Code -----------------
    const themeData = {
      "themes": [
        { 
          "name": "D", 
          "full_name": "Deterrence (प्रतिरोध)", 
          "score": 0.85, 
          "shlokas": [
            {
              "ref": "Bhagavad Gita 2.31",
              "text": "स्वधर्ममपि चावेक्ष्य न विकम्पितुमर्हसि | धर्म्याद्धि युद्धाच्छ्रेयोऽन्यत्क्षत्रियस्य न विद्यते ||",
              "translation": "Considering your duty as a warrior, you should not waver. For a warrior, there is no better engagement than fighting for the sake of duty.",
              "citation": "Gita Press, 2015, p. 12"
            },
            {
              "ref": "Mahabharata, Udyoga Parva 70.17",
              "text": "बलं धर्मस्य रक्षर्थमधर्मस्य निग्रहम्",
              "translation": "Strength is needed to protect righteousness and to suppress evil.",
              "citation": "Bhandarkar Oriental Research Institute, 1966, p. 312"
            }
          ]
        },
        { 
          "name": "E", 
          "full_name": "Ethical Restraint (नैतिक संयम)", 
          "score": 0.90, 
          "shlokas": [
            {
              "ref": "Bhagavad Gita 16.21",
              "text": "त्रिविधं नरकस्येदं द्वारं नाशनमात्मनः | कामः क्रोधस्तथा लोभस्तस्मादेतत्त्रयं त्यजेत् ||",
              "translation": "There are three gates to self-destruction: lust, anger, and greed. Therefore, one should abandon all three.",
              "citation": "Gita Press, 2015, p. 125"
            },
            {
              "ref": "Mahabharata, Shanti Parva 109.11",
              "text": "अहिंसा परमो धर्मः सर्वप्राणभृतां स्मृतः",
              "translation": "Non-violence is the highest duty towards all living beings.",
              "citation": "Bhandarkar Oriental Research Institute, 1966, p. 489"
            }
          ]
        },
        { 
          "name": "V", 
          "full_name": "Vengeance (प्रतिशोध)", 
          "score": 0.75, 
          "shlokas": [
            {
              "ref": "Bhagavad Gita 4.7-8",
              "text": "यदा यदा हि धर्मस्य ग्लानिर्भवति भारत | अभ्युत्थानमधर्मस्य तदात्मानं सृजाम्यहम् || परित्राणाय साधूनां विनाशाय च दुष्कृताम् | धर्मसंस्थापनार्थाय सम्भवामि युगे युगे ||",
              "translation": "Whenever there is a decline in righteousness and an increase in unrighteousness, I manifest myself to protect the good and destroy the wicked.",
              "citation": "Gita Press, 2015, p. 29"
            },
            {
              "ref": "Mahabharata, Udyoga Parva 72.18",
              "text": "दुष्टं दण्डयेद्धर्मज्ञो धर्मं रक्षेच्च सर्वदा",
              "translation": "The wicked must be punished and the righteous protected.",
              "citation": "Bhandarkar Oriental Research Institute, 1966, p. 315"
            }
          ]
        },
        { 
          "name": "I", 
          "full_name": "Institutional Authority (संस्थागत प्राधिकार)", 
          "score": 0.80, 
          "shlokas": [
            {
              "ref": "Mahabharata, Shanti Parva 87.30-31",
              "text": "राज्ञः कृत्स्नस्य जगतः स्रष्टुर्विधातुरेव च | धर्मरक्षणमेवात्र परमो धर्म उच्यते ||",
              "translation": "The king is responsible for the creation, maintenance and destruction of the whole world. The protection of Dharma by the king is considered the highest duty.",
              "citation": "Bhandarkar Oriental Research Institute, 1966, p. 401"
            },
            {
              "ref": "Arthashastra 1.4.3",
              "text": "प्रजासुखे सुखं राज्ञः प्रजानां च हिते हितम्",
              "translation": "In the happiness of the subjects lies the happiness of the king; in their welfare, his welfare.",
              "citation": "Shamasastry, 1915, p. 15"
            }
          ]
        },
        { 
          "name": "K", 
          "full_name": "Karmik Consequences (कर्मिक परिणाम)", 
          "score": 0.70, 
          "shlokas": [
            {
              "ref": "Bhagavad Gita 4.17",
              "text": "कर्मणो ह्यपि बोद्धव्यं बोद्धव्यं च विकर्मणः | अकर्मणश्च बोद्धव्यं गहना कर्मणो गतिः ||",
              "translation": "One should understand the nature of proper action, improper action, and inaction. The path of action is profound.",
              "citation": "Gita Press, 2015, p. 31"
            },
            {
              "ref": "Mahabharata, Vana Parva 313.116",
              "text": "यादृशं कुरुते कर्म तादृशं फलमश्नुते",
              "translation": "As one sows, so shall one reap.",
              "citation": "Bhandarkar Oriental Research Institute, 1966, p. 212"
            }
          ]
        },
        { 
          "name": "A", 
          "full_name": "Ahimsa (अहिंसा)", 
          "score": 0.95, 
          "shlokas": [
            {
              "ref": "Bhagavad Gita 13.8-12",
              "text": "अहिंसा सत्यमक्रोधस्त्यागः शान्तिरपैशुनम् | दया भूतेष्वलोलुप्त्वं मार्दवं ह्रीरचापलम् ||",
              "translation": "Non-violence, truthfulness, absence of anger, renunciation, peacefulness, compassion for all beings - these are the virtues to be cultivated.",
              "citation": "Gita Press, 2015, p. 96"
            },
            {
              "ref": "Yajurveda 36.18",
              "text": "दिव्यं सुपर्णं विहयं दूराद्विचक्ष आनशे | सर्वा दिशो विचक्षणं सर्वा आशा विचक्षणम् ||",
              "translation": "For vision of the distant, give us eye, harming none, may all beings look on us with the eye of friendliness.",
              "citation": "Griffith, 1899, p. 298"
            }
          ]
        }
      ]
    };

    // ----------------- DOM Elements -----------------
    const showButton = document.getElementById('show');
    const resultDiv = document.getElementById('result');
    const actionIndicator = document.getElementById('action-indicator');
    const verseModal = document.getElementById('verseModal');
    const devikaModal = document.getElementById('devikaModal');
    
    // ----------------- Event Listeners -----------------
    showButton.addEventListener('click', function() {
      const enemy = document.getElementById('enemy').value;
      const mode = document.getElementById('mode').value;
      const response = responses[enemy][mode];
      
      // Update the response card
      resultDiv.innerHTML = `
        <div class="response-card">
          <div class="response-title">${response.title}</div>
          <div class="escalation ${response.escalation}">Escalation Level: ${response.escalation.toUpperCase()}</div>
          <p><strong>Recommended Response:</strong> ${response.response}</p>
          
          <div class="doctrine-point">
            <strong>Doctrine Application:</strong>
            <ul>
              ${response.doctrine.map(point => `<li>${point}</li>`).join('')}
            </ul>
          </div>
          
          <div class="doctrine-point">
            <strong>Dharmic Consideration:</strong> ${response.ethics}
          </div>
          
          <div class="cite">
            <strong>Primary Citation:</strong> <span class="citation-link" onclick="showVerse('${response.citation}')">${response.citation}</span>
          </div>
        </div>
      `;
      
      // Update action indicator
      const enemyText = document.getElementById('enemy').options[document.getElementById('enemy').selectedIndex].text;
      const modeText = mode === 'strict' ? 'Strict Doctrine' : 'Ethics-First';
      actionIndicator.textContent = `Current Analysis: ${enemyText} (${modeText})`;
      
      // Update DEVIKA charts with response-specific data
      updateDevikaCharts(response.devikaScores);
    });

    // Modal close buttons
    document.getElementById('closeVerseModal').addEventListener('click', () => {
      verseModal.classList.remove('visible');
    });
    
    document.getElementById('closeDevikaModal').addEventListener('click', () => {
      devikaModal.classList.remove('visible');
    });
    
    // Close modals when clicking outside
    verseModal.addEventListener('click', (e) => {
      if (e.target === verseModal) {
        verseModal.classList.remove('visible');
      }
    });
    
    devikaModal.addEventListener('click', (e) => {
      if (e.target === devikaModal) {
        devikaModal.classList.remove('visible');
      }
    });
    
    // Add click events to theme cards
    document.querySelectorAll('.theme-card').forEach((card, index) => {
      card.addEventListener('click', () => {
        showDevikaShlokaModal(themeData.themes[index]);
      });
    });

    // Show default response on page load
    document.getElementById('show').click();

    // ----------------- Functions -----------------
    function showVerse(citation) {
      const verse = verses[citation];
      if (!verse) {
        alert('Verse details not available for: ' + citation);
        return;
      }

      document.getElementById('verseTitle').textContent = citation;
      document.getElementById('verseContent').innerHTML = `
        <div class="sanskrit">${verse.sanskrit}</div>
        <div class="translation"><strong>Translation:</strong> ${verse.translation}</div>
        <div class="cite"><strong>Context:</strong> ${verse.context}</div>
      `;
      
      verseModal.classList.add('visible');
    }
    
    function updateDevikaChapters(responseScores) {
      // This function would update the DEVIKA theme cards based on response scores
      const themeCards = document.querySelectorAll('.theme-card');
      
      themeCards.forEach(card => {
        const themeLetter = card.querySelector('.theme-icon').textContent;
        const score = responseScores[themeLetter];
        
        // Update visual intensity based on score
        card.style.opacity = 0.3 + (score * 0.7);
      });
    }
    
    function updateDevikaCharts(responseScores) {
      // Destroy existing charts if they exist
      if (window.barChartInstance) window.barChartInstance.destroy();
      if (window.radarChartInstance) window.radarChartInstance.destroy();
      if (window.pieChartInstance) window.pieChartInstance.destroy();
      
      // Prepare data for charts based on response scores
      const labels = themeData.themes.map(t => t.full_name);
      const backgroundColors = [
        'rgba(255, 159, 64, 0.8)',  // D - Orange
        'rgba(54, 162, 235, 0.8)',   // E - Blue
        'rgba(255, 99, 132, 0.8)',   // V - Red
        'rgba(75, 192, 192, 0.8)',   // I - Teal
        'rgba(153, 102, 255, 0.8)',  // K - Purple
        'rgba(102, 204, 153, 0.8)'   // A - Green
      ];
      
      const borderColors = [
        'rgb(255, 159, 64)',
        'rgb(54, 162, 235)',
        'rgb(255, 99, 132)',
        'rgb(75, 192, 192)',
        'rgb(153, 102, 255)',
        'rgb(102, 204, 153)'
      ];
      
      const scores = [
        responseScores.D || 0,
        responseScores.E || 0,
        responseScores.V || 0,
        responseScores.I || 0,
        responseScores.K || 0,
        responseScores.A || 0
      ];
      
      // Bar Chart
      const barCtx = document.getElementById('barChart').getContext('2d');
      window.barChartInstance = new Chart(barCtx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Theme Relevance Score',
            data: scores,
            backgroundColor: backgroundColors,
            borderColor: borderColors,
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              max: 1,
              title: {
                display: true,
                text: 'Relevance Score (0-1)'
              }
            }
          },
          plugins: {
            tooltip: {
              callbacks: {
                label: function(context) {
                  return `Relevance: ${context.raw.toFixed(2)}`;
                }
              }
            }
          },
          onClick: (e, activeEls) => {
            if (activeEls.length > 0) {
              const index = activeEls[0].index;
              const theme = themeData.themes[index];
              showDevikaShlokaModal(theme);
            }
          }
        }
      });
      
      // Radar Chart
      const radarCtx = document.getElementById('radarChart').getContext('2d');
      window.radarChartInstance = new Chart(radarCtx, {
        type: 'radar',
        data: {
          labels: labels,
          datasets: [{
            label: 'Theme Balance',
            data: scores,
            backgroundColor: 'rgba(54, 162, 235, 0.2)',
            borderColor: 'rgba(54, 162, 235, 0.8)',
            pointBackgroundColor: borderColors,
            pointBorderColor: '#fff',
            pointHoverBackgroundColor: '#fff',
            pointHoverBorderColor: 'rgba(54, 162, 235, 1)',
            pointRadius: 4
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            r: {
              beginAtZero: true,
              max: 1,
              ticks: {
                stepSize: 0.2
              }
            }
          },
          onClick: (e, activeEls) => {
            if (activeEls.length > 0) {
              const index = activeEls[0].index;
              const theme = themeData.themes[index];
              showDevikaShlokaModal(theme);
            }
          }
        }
      });
      
      // Pie Chart
      const pieCtx = document.getElementById('pieChart').getContext('2d');
      window.pieChartInstance = new Chart(pieCtx, {
        type: 'pie',
        data: {
          labels: labels,
          datasets: [{
            data: scores.map(s => s * 10), // Scale for better visualization
            backgroundColor: backgroundColors,
            borderColor: borderColors,
            borderWidth: 1
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            tooltip: {
              callbacks: {
                label: function(context) {
                  return `${context.label}: ${(context.raw/10).toFixed(2)}`;
                }
              }
            }
          },
          onClick: (e, activeEls) => {
            if (activeEls.length > 0) {
              const index = activeEls[0].index;
              const theme = themeData.themes[index];
              showDevikaShlokaModal(theme);
            }
          }
        }
      });
      
      // Also update the theme cards
      updateDevikaChapters(responseScores);
    }
    
    function showDevikaShlokaModal(theme) {
      document.getElementById('devikaTitle').textContent = `Scriptural References for ${theme.full_name}`;
      
      let contentHTML = '';
      theme.shlokas.forEach(shloka => {
        contentHTML += `
          <div class="shloka-item">
            <div class="font-bold text-lg mb-2">${shloka.ref}</div>
            <div class="text-md mb-2" style="color: #fbbf24; font-style: italic;">${shloka.text}</div>
            <div class="text-sm mb-1"><strong>Translation:</strong> ${shloka.translation}</div>
            <div class="text-xs italic"><strong>Source:</strong> ${shloka.citation}</div>
          </div>
        `;
      });
      
      document.getElementById('devikaContent').innerHTML = contentHTML;
      devikaModal.classList.add('visible');
    }
  </script>
</body>
</html>